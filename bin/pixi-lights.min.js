!function e(t,r,i){function n(a,l){if(!r[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return n(r?r:e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){t.exports=PIXI.lights={Light:e("./lights/light/Light"),LightShader:e("./lights/light/LightShader"),AmbientLight:e("./lights/ambientLight/AmbientLight"),AmbientLightShader:e("./lights/ambientLight/AmbientLightShader"),PointLight:e("./lights/pointLight/PointLight"),PointLightShader:e("./lights/pointLight/PointLightShader"),LightRenderer:e("./renderers/LightRenderer"),WebGLDeferredRenderer:e("./renderers/WebGLDeferredRenderer"),WireframeShader:e("./lights/WireframeShader")},e("./lightSpriteMixin"),e("./shapeMeshMixin")},{"./lightSpriteMixin":2,"./lights/WireframeShader":3,"./lights/ambientLight/AmbientLight":4,"./lights/ambientLight/AmbientLightShader":5,"./lights/light/Light":6,"./lights/light/LightShader":7,"./lights/pointLight/PointLight":8,"./lights/pointLight/PointLightShader":9,"./renderers/LightRenderer":10,"./renderers/WebGLDeferredRenderer":11,"./shapeMeshMixin":12}],2:[function(e,t,r){PIXI.Sprite.prototype._renderWebGL=function(e){this._originalTexture||(this._originalTexture=this._texture),this._texture=e.renderingNormals&&this.normalTexture?this.normalTexture:this._originalTexture,e.setObjectRenderer(e.plugins.sprite),e.plugins.sprite.render(this)}},{}],3:[function(e,t,r){function i(e){PIXI.Shader.call(this,e,["precision lowp float;","attribute vec2 aVertexPosition;","uniform mat3 projectionMatrix;","void main(void) {","    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","}"].join("\n"),["void main() {","    gl_FragColor = vec4(0, 0, 0, 1);","}"].join("\n"),{translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}i.prototype=Object.create(PIXI.Shader.prototype),i.prototype.constructor=i,t.exports=i,PIXI.ShaderManager.registerPlugin("wireframeShader",i)},{}],4:[function(e,t,r){function i(e,t){n.call(this,e,t),this.shaderName="ambientLightShader"}var n=e("../light/Light");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,t.exports=i,i.prototype.renderWebGL=function(e){e.renderingNormals&&(this.vertices[2]=this.vertices[4]=e.width,this.vertices[5]=this.vertices[7]=e.height,e.plugins.lights.render(this))}},{"../light/Light":6}],5:[function(e,t,r){function i(e){n.call(this,e,null,'#define GLSLIFY 1\n\nprecision lowp float;\r\n\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uNormalSampler;\r\n\r\nuniform mat3 translationMatrix;\r\n\r\nuniform vec2 uViewSize;\r\n\r\nuniform vec4 uAmbientColor; // ambient color, alpha channel used for intensity.\r\n\r\nuniform vec4 uLightColor;   // light color, alpha channel used for intensity.\r\nuniform vec3 uLightFalloff; // light attenuation coefficients (constant, linear, quadratic)\r\nuniform float uLightHeight; // light height above the viewport\r\n\n\r\nvoid main(void)\r\n{\r\nvec2 texCoord = gl_FragCoord.xy / uViewSize;\r\ntexCoord.y = 1.0 - texCoord.y; // FBOs are flipped.\r\n\r\nvec4 diffuseColor = texture2D(uSampler, texCoord);\r\nvec4 normalColor = texture2D(uNormalSampler, texCoord);\r\n\r\n// if no normal color here, just discard\r\nif (normalColor.a == 0.0) discard;\r\n\n\r\n    // simplified lambert shading that makes assumptions for ambient color\r\n\r\n    // compute Distance\r\n//    float D = length(lightVector);\r\n    float D = 1.0;\r\n    \r\n    // normalize vectors\r\n    vec3 N = normalize(normalColor.xyz * 2.0 - 1.0);\r\n//    vec3 L = normalize(lightVector);\r\n    vec3 L = vec3(1.0, 1.0, 1.0);\r\n    \r\n    // pre-multiply light color with intensity\r\n    // then perform "N dot L" to determine our diffuse\r\n    vec3 diffuse = (uLightColor.rgb * uLightColor.a) * max(dot(N, L), 0.0);\r\n    \r\n    // pre-multiply ambient color with intensity\r\n//    vec3 ambient = uAmbientColor.rgb * uAmbientColor.a;\r\n    \r\n    // calculate attenuation\r\n//    float attenuation = 1.0 / (uLightFalloff.x + (uLightFalloff.y * D) + (uLightFalloff.z * D * D));\r\n    \r\n    // calculate final intesity and color, then combine\r\n//    vec3 intensity = ambient + diffuse * attenuation;\r\n//    vec3 finalColor = diffuseColor.rgb * intensity;\r\n    vec3 finalColor = diffuseColor.rgb * diffuse;\r\n\r\n    // calculate just ambient light color, most lights will override this frag\r\n//    vec3 ambientColor = uLightColor.rgb * uLightColor.a;\r\n//    gl_FragColor = vec4(diffuseColor.rgb * ambientColor, diffuseColor.a);\r\n    gl_FragColor = vec4(finalColor, diffuseColor.a);\r\n}\r\n')}var n=e("../light/LightShader");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,t.exports=i,PIXI.ShaderManager.registerPlugin("ambientLightShader",i)},{"../light/LightShader":7}],6:[function(e,t,r){function i(e,t,r,n){if(this.constructor===i)throw new Error("Light is an abstract base class, it should not be created directly!");PIXI.DisplayObject.call(this),this.vertices=r||new Float32Array(8),this.indices=n||new Uint16Array([0,1,2,0,2,3]),this.blendMode=PIXI.BLEND_MODES.ADD,this.drawMode=PIXI.DRAW_MODES.TRIANGLES,this.needsUpdate=!0,this.height=.075,this.falloff=[.75,3,7],this.shaderName=null,this._vertexBuffer=null,this._indexBuffer=null,this._color=5066073,this._colorRgba=[.3,.3,.35,.8],(e||0===e)&&(this.color=e),(t||0===t)&&(this.brightness=t)}i.prototype=Object.create(PIXI.DisplayObject.prototype),i.prototype.constructor=i,t.exports=i,Object.defineProperties(i.prototype,{color:{get:function(){return this._color},set:function(e){this._color=e,PIXI.utils.hex2rgb(e,this._colorRgba)}},brightness:{get:function(){return this._colorRgba[3]},set:function(e){this._colorRgba[3]=e}}}),i.prototype.syncShader=function(e){e.uniforms.uLightColor.value[0]=this._colorRgba[0],e.uniforms.uLightColor.value[1]=this._colorRgba[1],e.uniforms.uLightColor.value[2]=this._colorRgba[2],e.uniforms.uLightColor.value[3]=this._colorRgba[3],e.uniforms.uLightHeight.value=this.height,e.uniforms.uLightFalloff.value[0]=this.falloff[0],e.uniforms.uLightFalloff.value[1]=this.falloff[1],e.uniforms.uLightFalloff.value[2]=this.falloff[2]},i.prototype.renderWebGL=function(e){e.renderingNormals&&e.plugins.lights.render(this)},i.prototype.destroy=function(){PIXI.DisplayObject.prototype.destroy.call(this)},i.DRAW_MODES={}},{}],7:[function(e,t,r){function i(e,t,r,n,o){var a={translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)},uSampler:{type:"sampler2D",value:null},uNormalSampler:{type:"sampler2D",value:null},uViewSize:{type:"2f",value:new Float32Array(2)},uLightColor:{type:"4f",value:new Float32Array([1,1,1,1])},uLightFalloff:{type:"3f",value:new Float32Array([0,0,0])},uLightHeight:{type:"1f",value:.075}};if(n)for(var l in n)a[l]=n[l];var s={aVertexPosition:0};if(o)for(var h in o)s[h]=o[h];PIXI.Shader.call(this,e,t||i.defaultVertexSrc,r,a,s)}i.prototype=Object.create(PIXI.Shader.prototype),i.prototype.constructor=i,t.exports=i,i.defaultVertexSrc="#define GLSLIFY 1\n\nprecision lowp float;\r\n\r\nattribute vec2 aVertexPosition;\r\n\r\nuniform mat3 translationMatrix;\r\nuniform mat3 projectionMatrix;\r\n\r\nvoid main(void) {\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n}\r\n"},{}],8:[function(e,t,r){function i(e,t,r,i){var o=new PIXI.math.Circle(200,200,r||256),a=o.getMesh();n.call(this,e,t,a.vertices,a.indices),this._syncShader=n.prototype.syncShader,this.radius=o.radius,this.decay=i||0,this.drawMode=PIXI.DRAW_MODES.TRIANGLE_FAN,this.shaderName="pointLightShader"}var n=e("../light/Light");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,t.exports=i,i.prototype.syncShader=function(e){this._syncShader(e),e.uniforms.uLightRadius.value=this.radius}},{"../light/Light":6}],9:[function(e,t,r){function i(e){n.call(this,e,null,'#define GLSLIFY 1\n\nprecision lowp float;\r\n\r\n// imports the common uniforms like samplers, and ambient color\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uNormalSampler;\r\n\r\nuniform mat3 translationMatrix;\r\n\r\nuniform vec2 uViewSize;\r\n\r\nuniform vec4 uAmbientColor; // ambient color, alpha channel used for intensity.\r\n\r\nuniform vec4 uLightColor;   // light color, alpha channel used for intensity.\r\nuniform vec3 uLightFalloff; // light attenuation coefficients (constant, linear, quadratic)\r\nuniform float uLightHeight; // light height above the viewport\r\n\n\r\nuniform float uLightRadius;\r\n\r\nvoid main()\r\n{\r\n    vec2 texCoord = gl_FragCoord.xy / uViewSize;\r\n    texCoord.y = 1.0 - texCoord.y; // FBOs positions are flipped.\r\n\r\n    vec4 normalColor = texture2D(uNormalSampler, texCoord);\r\n    normalColor.g = 1.0 - normalColor.g; // Green layer is flipped Y coords.\r\n\r\n    // bail out early when normal has no data\r\n    if (normalColor.a == 0.0) discard;\r\n\r\n    vec2 lightPosition = translationMatrix[2].xy / uViewSize;\r\n\r\n    // the directional vector of the light\r\n    vec3 lightVector = vec3(lightPosition - texCoord, uLightHeight);\r\n\r\n    // correct for aspect ratio\r\n    lightVector.x *= uViewSize.x / uViewSize.y;\r\n\r\n    // compute Distance\r\n    float D = length(lightVector);\r\n\r\n    // bail out early when pixel outside of light sphere\r\n    if (D > uLightRadius) discard;\r\n\r\n    // normalize vectors\r\n    vec3 N = normalize(normalColor.xyz * 2.0 - 1.0);\r\n    vec3 L = normalize(lightVector);\r\n    \r\n    // pre-multiply light color with intensity\r\n    // then perform "N dot L" to determine our diffuse\r\n    vec3 diffuse = (uLightColor.rgb * uLightColor.a) * max(dot(N, L), 0.0);\r\n\r\n    // calculate attenuation\r\n    float attenuation = 1.0 / (uLightFalloff.x + (uLightFalloff.y * D) + (uLightFalloff.z * D * D));\r\n    \r\n    // calculate final intesity and color, then combine\r\n    vec3 intensity = diffuse * attenuation;\r\n    vec4 diffuseColor = texture2D(uSampler, texCoord);\r\n    vec3 finalColor = diffuseColor.rgb * intensity;\r\n\r\n    gl_FragColor = vec4(finalColor, diffuseColor.a);\r\n}',{uLightRadius:{type:"1f",value:1}})}var n=e("../light/LightShader");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,t.exports=i,PIXI.ShaderManager.registerPlugin("pointLightShader",i)},{"../light/LightShader":7}],10:[function(e,t,r){function i(e){PIXI.ObjectRenderer.call(this,e);var t=6*i.MAX_LIGHTS;this.indices=new Uint16Array(t);for(var r=0,n=0;t>r;r+=6,n+=4)this.indices[r+0]=n+0,this.indices[r+1]=n+1,this.indices[r+2]=n+2,this.indices[r+3]=n+0,this.indices[r+4]=n+2,this.indices[r+5]=n+3;this.currentBatchSize=0,this.lights=[]}i.MAX_LIGHTS=500,i.prototype=Object.create(PIXI.ObjectRenderer.prototype),i.prototype.constructor=i,t.exports=i,PIXI.WebGLRenderer.registerPlugin("lights",i),i.prototype.render=function(e){this.lights[this.currentBatchSize++]=e},i.prototype.flush=function(){for(var e=this.renderer,t=e.gl,r=e.diffuseTexture,i=e.normalsTexture,n=null,o=0;o<this.currentBatchSize;++o){var a=this.lights[o],l=a.shader||this.renderer.shaderManager.plugins[a.shaderName];a._vertexBuffer||this._initWebGL(a),l!==n&&(n=l,e.shaderManager.setShader(l)),e.blendModeManager.setBlendMode(a.blendMode),l.uniforms.uViewSize.value[0]=e.width,l.uniforms.uViewSize.value[1]=e.height,a.worldTransform.toArray(!0,l.uniforms.translationMatrix.value),e.currentRenderTarget.projectionMatrix.toArray(!0,l.uniforms.projectionMatrix.value),a.syncShader(l),l.syncUniforms(),t.uniform1i(l.uniforms.uSampler._location,0),t.uniform1i(l.uniforms.uNormalSampler._location,1),a.needsUpdate?(a.needsUpdate=!1,t.bindBuffer(t.ARRAY_BUFFER,a._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,a.vertices,t.STATIC_DRAW),t.vertexAttribPointer(l.attributes.aVertexPosition,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.baseTexture._glTextures[t.id]),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,i.baseTexture._glTextures[t.id]),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,a.indices,t.STATIC_DRAW)):(t.bindBuffer(t.ARRAY_BUFFER,a._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,a.vertices),t.vertexAttribPointer(l.attributes.aVertexPosition,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.baseTexture._glTextures[t.id]),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,i.baseTexture._glTextures[t.id]),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a._indexBuffer),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,a.indices)),t.drawElements(t.TRIANGLE_FAN,a.indices.length,t.UNSIGNED_SHORT,0)}this.currentBatchSize=0},i.prototype._initWebGL=function(e){var t=this.renderer.gl;e._vertexBuffer=t.createBuffer(),e._indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,e.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW)},i.prototype.destroy=function(){}},{}],11:[function(e,t,r){function i(e,t,r){r=r||{},this.renderingNormals=!1,PIXI.WebGLRenderer.call(this,e,t,r)}i.prototype=Object.create(PIXI.WebGLRenderer.prototype),i.prototype.constructor=i,t.exports=i,Object.assign(i.prototype,{_initContext:function(){PIXI.WebGLRenderer.prototype._initContext.call(this),this.diffuseTexture=new PIXI.RenderTexture(this,this.width,this.height,null,this.resolution),this.normalsTexture=new PIXI.RenderTexture(this,this.width,this.height,null,this.resolution)},render:function(e){this.renderingNormals=!1,this.diffuseTexture.render(e),this.renderingNormals=!0,this.normalsTexture.render(e),this.setRenderTarget(this.renderTarget),this.setObjectRenderer(this.plugins.lights),this.plugins.lights.flush()}})},{}],12:[function(e,t,r){PIXI.math.Circle.prototype.getMesh=function(e,t,r){e=e||40,t=t||new Float32Array(2*(e+1)),r=r||new Uint16Array(e+1);var i=2*Math.PI/e,n=-1;r[++n]=n;for(var o=0;e>=o;++o){var a=2*o,l=i*o;t[a]=Math.cos(l)*this.radius,t[a+1]=Math.sin(l)*this.radius,r[++n]=n}return r[n]=1,{vertices:t,indices:r}}},{}]},{},[1]);